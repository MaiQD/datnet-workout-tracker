@implements IDisposable

<nav class="nav-menu">
    <!-- Brand Section -->
    <div class="brand-section">
        <div class="brand-logo">
            <div class="logo-icon">ðŸ’ª</div>
            <div class="brand-text">
                <div class="brand-name">DatNet</div>
                <div class="brand-subtitle">Fitness</div>
            </div>
        </div>
    </div>

    <!-- Navigation Items -->
    <div class="nav-sections">
        <!-- Main Navigation -->
        <div class="nav-section">
            <div class="nav-section-title">Main</div>
            <ul class="nav-items">
                <li class="nav-item">
                    <NavLink class="nav-link" href="" Match="NavLinkMatch.All" @onclick="() => OnMenuItemClick.InvokeAsync()">
                        <div class="nav-link-content">
                            <span class="nav-icon oi oi-home"></span>
                            <span class="nav-text">Dashboard</span>
                        </div>
                        <div class="nav-indicator"></div>
                    </NavLink>
                </li>
            </ul>
        </div>

        <!-- Workout Management -->
        <AuthorizeView>
            <Authorized>
                <div class="nav-section">
                    <div class="nav-section-title">Workouts</div>
                    <ul class="nav-items">
                        <li class="nav-item">
                            <NavLink class="nav-link" href="workouts" @onclick="() => OnMenuItemClick.InvokeAsync()">
                                <div class="nav-link-content">
                                    <span class="nav-icon oi oi-flash"></span>
                                    <span class="nav-text">My Workouts</span>
                                </div>
                                <div class="nav-indicator"></div>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="routines" @onclick="() => OnMenuItemClick.InvokeAsync()">
                                <div class="nav-link-content">
                                    <span class="nav-icon oi oi-list-rich"></span>
                                    <span class="nav-text">Routines</span>
                                </div>
                                <div class="nav-indicator"></div>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="exercises" @onclick="() => OnMenuItemClick.InvokeAsync()">
                                <div class="nav-link-content">
                                    <span class="nav-icon oi oi-book"></span>
                                    <span class="nav-text">Exercise Library</span>
                                </div>
                                <div class="nav-indicator"></div>
                            </NavLink>
                        </li>
                    </ul>
                </div>

                <!-- Analytics & Planning -->
                <div class="nav-section">
                    <div class="nav-section-title">Insights</div>
                    <ul class="nav-items">
                        <li class="nav-item">
                            <NavLink class="nav-link" href="analytics" @onclick="() => OnMenuItemClick.InvokeAsync()">
                                <div class="nav-link-content">
                                    <span class="nav-icon oi oi-bar-chart"></span>
                                    <span class="nav-text">Analytics</span>
                                </div>
                                <div class="nav-indicator"></div>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="calendar" @onclick="() => OnMenuItemClick.InvokeAsync()">
                                <div class="nav-link-content">
                                    <span class="nav-icon oi oi-calendar"></span>
                                    <span class="nav-text">Calendar</span>
                                </div>
                                <div class="nav-indicator"></div>
                            </NavLink>
                        </li>
                    </ul>
                </div>
            </Authorized>
        </AuthorizeView>

        <!-- Quick Actions -->
        <AuthorizeView>
            <Authorized>
                <div class="nav-section">
                    <div class="nav-section-title">Quick Actions</div>
                    <div class="quick-actions">
                        <a href="/workouts/new" class="quick-action-btn primary" @onclick="() => OnMenuItemClick.InvokeAsync()">
                            <span class="oi oi-plus"></span>
                            <span>New Workout</span>
                        </a>
                        <a href="/routines" class="quick-action-btn secondary" @onclick="() => OnMenuItemClick.InvokeAsync()">
                            <span class="oi oi-list-rich"></span>
                            <span>Browse Routines</span>
                        </a>
                    </div>
                </div>
            </Authorized>
        </AuthorizeView>

        <!-- Footer Section -->
        <div class="nav-footer">
            <div class="nav-footer-content">
                <div class="version-info">
                    <small>Version 2.0</small>
                </div>
                <div class="social-links">
                    <a href="#" class="social-link" title="Support">
                        <span class="oi oi-question-mark"></span>
                    </a>
                    <a href="#" class="social-link" title="Feedback">
                        <span class="oi oi-heart"></span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</nav>

<style>
    /* ===== NAVIGATION MENU ===== */
    .nav-menu {
        display: flex;
        flex-direction: column;
        height: 100%;
        background: var(--gradient-secondary);
        color: white;
        position: relative;
        overflow: hidden;
    }

    .nav-menu::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: 
            radial-gradient(circle at 20% 50%, rgba(232, 69, 69, 0.1) 0%, transparent 50%),
            radial-gradient(circle at 80% 20%, rgba(144, 55, 73, 0.1) 0%, transparent 50%),
            radial-gradient(circle at 40% 80%, rgba(83, 53, 74, 0.1) 0%, transparent 50%);
        pointer-events: none;
    }

    /* ===== BRAND SECTION ===== */
    .brand-section {
        padding: var(--space-6) var(--space-6) var(--space-4);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        position: relative;
        z-index: 1;
    }

    .brand-logo {
        display: flex;
        align-items: center;
        gap: var(--space-4);
    }

    .logo-icon {
        font-size: 2.5rem;
        background: var(--gradient-primary);
        width: 56px;
        height: 56px;
        border-radius: var(--radius-xl);
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 8px 32px rgba(232, 69, 69, 0.3);
        animation: pulse 3s infinite;
    }

    .brand-text {
        flex: 1;
    }

    .brand-name {
        font-size: var(--font-size-2xl);
        font-weight: 800;
        color: white;
        line-height: 1;
        margin-bottom: var(--space-1);
        letter-spacing: -0.02em;
    }

    .brand-subtitle {
        font-size: var(--font-size-sm);
        color: rgba(255, 255, 255, 0.7);
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.1em;
    }

    /* ===== NAVIGATION SECTIONS ===== */
    .nav-sections {
        flex: 1;
        padding: var(--space-4) 0;
        overflow-y: auto;
        position: relative;
        z-index: 1;
    }

    .nav-section {
        margin-bottom: var(--space-6);
    }

    .nav-section-title {
        font-size: var(--font-size-xs);
        font-weight: 700;
        color: rgba(255, 255, 255, 0.6);
        text-transform: uppercase;
        letter-spacing: 0.1em;
        padding: 0 var(--space-6) var(--space-3);
        margin-bottom: var(--space-2);
    }

    .nav-items {
        list-style: none;
        margin: 0;
        padding: 0;
    }

    .nav-item {
        position: relative;
    }

    /* ===== NAVIGATION LINKS ===== */
    .nav-link {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: var(--space-4) var(--space-6);
        color: rgba(255, 255, 255, 0.8);
        text-decoration: none;
        transition: all var(--transition-normal);
        position: relative;
        margin: 0 var(--space-3);
        border-radius: var(--radius-lg);
        backdrop-filter: blur(10px);
    }

    .nav-link-content {
        display: flex;
        align-items: center;
        gap: var(--space-4);
        flex: 1;
    }

    .nav-icon {
        font-size: var(--font-size-lg);
        width: 20px;
        text-align: center;
        transition: transform var(--transition-fast);
    }

    .nav-text {
        font-weight: 600;
        font-size: var(--font-size-base);
    }

    .nav-indicator {
        width: 4px;
        height: 20px;
        background: var(--color-red);
        border-radius: 2px;
        opacity: 0;
        transition: opacity var(--transition-normal);
    }

    /* ===== NAVIGATION STATES ===== */
    .nav-link:hover {
        color: white;
        background: rgba(255, 255, 255, 0.1);
        transform: translateX(4px);
    }

    .nav-link:hover .nav-icon {
        transform: scale(1.1);
        color: var(--color-red);
    }

    .nav-link.active {
        color: white;
        background: rgba(232, 69, 69, 0.2);
        border: 1px solid rgba(232, 69, 69, 0.3);
        box-shadow: 0 4px 20px rgba(232, 69, 69, 0.2);
    }

    .nav-link.active .nav-icon {
        color: var(--color-red);
        transform: scale(1.1);
    }

    .nav-link.active .nav-indicator {
        opacity: 1;
    }

    /* ===== QUICK ACTIONS ===== */
    .quick-actions {
        padding: 0 var(--space-6);
        display: flex;
        flex-direction: column;
        gap: var(--space-3);
    }

    .quick-action-btn {
        display: flex;
        align-items: center;
        gap: var(--space-3);
        padding: var(--space-3) var(--space-4);
        border-radius: var(--radius-lg);
        text-decoration: none;
        font-weight: 600;
        font-size: var(--font-size-sm);
        transition: all var(--transition-fast);
        backdrop-filter: blur(10px);
    }

    .quick-action-btn.primary {
        background: var(--gradient-primary);
        color: white;
        box-shadow: 0 4px 15px rgba(232, 69, 69, 0.3);
    }

    .quick-action-btn.primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(232, 69, 69, 0.4);
        color: white;
    }

    .quick-action-btn.secondary {
        background: rgba(255, 255, 255, 0.1);
        color: rgba(255, 255, 255, 0.9);
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .quick-action-btn.secondary:hover {
        background: rgba(255, 255, 255, 0.15);
        color: white;
        transform: translateY(-1px);
    }

    /* ===== NAVIGATION FOOTER ===== */
    .nav-footer {
        padding: var(--space-4) var(--space-6);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        position: relative;
        z-index: 1;
    }

    .nav-footer-content {
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .version-info small {
        color: rgba(255, 255, 255, 0.5);
        font-weight: 500;
    }

    .social-links {
        display: flex;
        gap: var(--space-2);
    }

    .social-link {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 32px;
        height: 32px;
        border-radius: var(--radius-md);
        color: rgba(255, 255, 255, 0.6);
        transition: all var(--transition-fast);
        text-decoration: none;
    }

    .social-link:hover {
        background: rgba(255, 255, 255, 0.1);
        color: var(--color-red);
        transform: scale(1.1);
    }

    /* ===== RESPONSIVE DESIGN ===== */
    @@media (max-width: 991.98px) {
        .brand-logo {
            justify-content: center;
        }
        
        .nav-section-title {
            text-align: center;
        }
        
        .quick-actions {
            padding: 0 var(--space-4);
        }
        
        .nav-link {
            margin: 0 var(--space-2);
        }
    }

    @@media (max-width: 576px) {
        .brand-section {
            padding: var(--space-4);
        }
        
        .logo-icon {
            width: 48px;
            height: 48px;
            font-size: 2rem;
        }
        
        .brand-name {
            font-size: var(--font-size-xl);
        }
        
        .nav-link {
            padding: var(--space-3) var(--space-4);
        }
    }

    /* ===== SCROLLBAR STYLING ===== */
    .nav-sections::-webkit-scrollbar {
        width: 6px;
    }

    .nav-sections::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 3px;
    }

    .nav-sections::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.2);
        border-radius: 3px;
    }

    .nav-sections::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.3);
    }

    /* ===== ANIMATIONS ===== */
    @@keyframes navItemFadeIn {
        from {
            opacity: 0;
            transform: translateX(-20px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    .nav-item {
        animation: navItemFadeIn 0.3s ease-out forwards;
    }

    .nav-item:nth-child(1) { animation-delay: 0.1s; }
    .nav-item:nth-child(2) { animation-delay: 0.15s; }  
    .nav-item:nth-child(3) { animation-delay: 0.2s; }
    .nav-item:nth-child(4) { animation-delay: 0.25s; }
    .nav-item:nth-child(5) { animation-delay: 0.3s; }
</style>

@code {
    [Parameter] public EventCallback OnMenuItemClick { get; set; }

    private string GetActiveClass(string href)
    {
        var currentUri = NavigationManager.ToBaseRelativePath(NavigationManager.Uri);
        
        if (string.IsNullOrEmpty(href) && string.IsNullOrEmpty(currentUri))
            return "active";
            
        if (!string.IsNullOrEmpty(href) && currentUri.StartsWith(href, StringComparison.OrdinalIgnoreCase))
            return "active";
            
        return "";
    }

    public void Dispose()
    {
        // Cleanup if needed
    }
}

@inject NavigationManager NavigationManager
